name: Update Progress Bar

permissions:
  contents: write   # ðŸ‘ˆ THIS LINE FIXES EVERYTHING

on:
  push:
    branches:
      - main

jobs:
  progress:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repo
        uses: actions/checkout@v4

            - name: Update README progress
        run: |
          python << 'EOF'
          import re

          try:
              with open("README.md", "r", encoding="utf-8") as f:
                  content = f.read()

              xp_match = re.search(r'XP\\*\\*: (\\d+) / 100', content)
              bar_match = re.search(r'[ðŸŸ©â¬œ]{10} \\d+%', content)

              if not xp_match or not bar_match:
                  print("README format not matched. Skipping update.")
                  exit(0)

              xp = int(xp_match.group(1))
              xp = min(xp + 10, 100)

              blocks = xp // 10
              bar = "ðŸŸ©" * blocks + "â¬œ" * (10 - blocks)

              content = re.sub(
                  r'XP\\*\\*: \\d+ / 100',
                  f'XP**: {xp} / 100',
                  content
              )

              content = re.sub(
                  r'[ðŸŸ©â¬œ]{10} \\d+%',
                  f'{bar} {xp}%',
                  content
              )

              with open("README.md", "w", encoding="utf-8") as f:
                  f.write(content)

              print("README updated successfully.")

          except Exception as e:
              print("Error:", e)
              exit(0)
          EOF
